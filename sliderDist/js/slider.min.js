import{Animations}from"./animations";export default class Slider{constructor(t,i){void 0===i&&(i={navigation:!0,dots:!0,counter:!0,animationIn:"fadeInRight",animationOut:"fadeOutLeft",animationDuration:300,autoplay:!0,autoplayReversed:!1,autoplayTimeout:5e3,itemClass:""}),this._root=void 0!==t&&t?t:"#slider",this._slides=document.querySelectorAll(this._root+" .slider--item"),this._slidesCount=this._slides.length,this._next=document.querySelector(this._root+" .slider--next"),this._prev=document.querySelector(this._root+" .slider--previous"),this._dots=document.querySelector(this._root+" .slider--dots"),this._counter=document.querySelector(this._root+" .slider--counter"),this._currentIndex=0,this._isDisabled=!1,this.navigation=i.navigation,this.dots=i.dots,this.counter=i.counter,this.animationIn=i.animationIn,this.animationOut=i.animationOut,this.animationDuration=i.animationDuration,this.autoplay=i.autoplay,this.autoplayReversed=i.autoplayReversed,this.autoplayTimeout=i.autoplayTimeout,this.itemClass=i.itemClass}setRoot(t){void 0!==t&&t?this._root=t:this._root,document.querySelector(this._root).tabIndex="0"}getIndex(){return this._currentIndex}getPrevIndex(){return 0===this._currentIndex?this._slidesCount-1:this._currentIndex-1}getNextIndex(){return(this._currentIndex+1)%this._slidesCount==0?0:this._currentIndex+1}setIndex(t){var i;return(t&&t<this._slidesCount||0===t)&&(i=this._currentIndex,this._currentIndex=t,this._updateSlider(i)),this._currentIndex}setItemClass(i){if(""===this.itemClass)return 0;this._slides.forEach(t=>{t.classList.add(void 0!==i&&""!==i?i:this.itemClass)})}_addListener(t,i,e){t&&t.addEventListener(i,e.bind(this))}_initDots(){if(this._dots&&!0===this.dots)for(let i=0;i<this._slidesCount;i++){let t=document.createElement("button");0===i&&t.classList.add("active"),t.classList.add("slider--dot"),t.setAttribute("dotIndex",i),t.addEventListener("click",t=>{this._handleDot(i)}),this._dots.appendChild(t)}}_activeDot(){if(void 0!==this._dots&&!0===this.dots){let t=[...this._dots.children];t.forEach(t=>{t.classList.remove("active")}),t[this.getIndex()].classList.add("active")}}_Dots(){if(!0===this.dots)return 0;this._dots.remove()}_handlePrev(){this.setIndex(this.getPrevIndex())}_handleNext(){this.setIndex(this.getNextIndex())}_handleDot(t){this.setIndex(t)}_Navigation(){if(!this.navigation)return 0;void 0!==this._prev&&this._prev&&(this._prev.style.display="block"),void 0!==this._next&&this._next&&(this._next.style.display="block")}_Counter(){if(!this.counter)return 0;this._counter&&(this._counter.innerHTML=`<span class="slider--counter__current">${this.getIndex()<10?"0"+(this.getIndex()+1):this.getIndex()+1}</span><span class="slider--counter__divider"> / </span><span class="slider--counter__total"> ${this._slidesCount<10?"0"+this._slidesCount:this._slidesCount}</span>`)}_Autoplay(){if(!1===this.autoplay)return 0;let t=setTimeout(i.bind(this),this.autoplayTimeout);function i(){this.autoplayReversed?this._handlePrev():this._handleNext(),t=setTimeout(i.bind(this),this.autoplayTimeout)}}_showSlide(t){this._slides[t].classList.add("slider--item__active")}_hideSlide(t){this._slides[t].classList.remove("slider--item__active")}_animateSlide(t,i,e,s){let n=t.animate(i,e);n.addEventListener("finish",s)}_switchSlide(i){this._isDisabled=!0,this._animateSlide(this._slides[i],Animations[this.animationOut],this.animationDuration,t=>{this._hideSlide(i),this._showSlide(this.getIndex()),this._animateSlide(this._slides[this.getIndex()],Animations[this.animationIn],this.animationDuration,()=>{this._isDisabled=!1})})}_updateSlider(t=this._currentIndex){0!==this._slides&&(this._switchSlide(t),this._activeDot(),this._Counter())}show(){document.querySelector(this._root).tabIndex=0,this.dots?this._initDots():this._Dots(),this._Navigation(),this._Autoplay(),this._Counter(),this.setItemClass(),this._showSlide(this.getIndex()),this._addListener(this._next,"click",this._handleNext),this._addListener(this._prev,"click",this._handlePrev),this._addListener(document.querySelector(this._root),"keydown",t=>this._isDisabled?0:(37===t.keyCode&&this._handlePrev(),void(39===t.keyCode&&this._handleNext())))}}